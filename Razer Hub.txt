_G.FastAttack = true 

local workspace = game:GetService("Workspace")
local replicatedStorage = game:GetService("ReplicatedStorage")
local players = game:GetService("Players")
local localPlayer = players.LocalPlayer
local enemiesFolder = workspace:FindFirstChild("Enemies")
local delayTime = 0.1  -- ปรับเวลาระหว่างการโจมตีให้ช้าลงเพื่อหลีกเลี่ยงการถูกแบน
local attackDistance = 50 -- ระยะทางในการโจมตี (สามารถปรับให้มากขึ้นหรือน้อยลงได้)

local function getTarget()
    if enemiesFolder then
        for _, enemy in pairs(enemiesFolder:GetChildren()) do
            if enemy:IsA("Model") and enemy:FindFirstChild("Humanoid") and enemy.Humanoid.Health > 0 then
                -- ตรวจสอบระยะห่างระหว่างผู้เล่นกับมอนสเตอร์
                local distance = (enemy.HumanoidRootPart.Position - localPlayer.Character.HumanoidRootPart.Position).Magnitude
                if distance <= attackDistance then
                    return enemy
                end
            end
        end
    end
    return nil
end

-- ฟังก์ชันสำหรับโจมตีจากระยะไกล
local function fastAttack(target)
    if not target or not target:FindFirstChild("HumanoidRootPart") then return end

    local modules = replicatedStorage:FindFirstChild("Modules")
    if not modules then
        warn("Modules not found!")
        return
    end

    local net = modules:FindFirstChild("Net")
    if not net then
        warn("Net module not found!")
        return
    end

    local hitRemote = net:FindFirstChild("RE") and net.RE:FindFirstChild("RegisterHit")
    local attackRemote = net:FindFirstChild("RE") and net.RE:FindFirstChild("RegisterAttack")

    if hitRemote then
        local hitArgs = {
            [1] = target,
            [2] = {}
        }
        pcall(function()
            hitRemote:FireServer(unpack(hitArgs))
        end)
    else
        warn("RegisterHit remote not found!")
    end

    if attackRemote then
        local attackArgs = {
            [1] = 0.5 -- Delay or power of attack
        }
        pcall(function()
            attackRemote:FireServer(unpack(attackArgs))
        end)
    else
        warn("RegisterAttack remote not found!")
    end
end

-- ฟังก์ชันหลักที่ทำการโจมตีและค้นหามอนสเตอร์จากระยะไกล
while wait(delayTime) do
    -- ตรวจสอบว่า _G.FastAttack เปิดใช้งานหรือไม่
    if _G.FastAttack then
        local target = getTarget()
        if target then
            fastAttack(target)  -- เรียกใช้การโจมตี
        else
            print("No valid target found within attack range!")
        end
    end
end
